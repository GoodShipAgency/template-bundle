{#
options
    links
        name: label of nav item
        path: url
        icon: '<path>'
        show: bool
blocks
    logo
#}

{% set links = links|filter(l => l.show is not defined or l.show) %}

{% set logo %}
    {% block logo %}{% endblock %}
{% endset %}

{% set navItemClass = "flex items-center px-2 py-2 text-sm leading-6 font-medium rounded-md focus:outline-none transition ease-in-out duration-150 group" %}
{% set navItemIconClass = "mr-4 h-6 w-6 transition ease-in-out duration-150" %}

{% set links %}
    {% block links %}
        {% for link in links %}
            {% if link.path == app.request.pathInfo() %}
                <a href="{{ link.path }}" class="{{ navItemClass }} side-nav__item--active">
                    <svg class="{{ navItemIconClass }} side-nav__item-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        {{ link.icon|raw }}
                    </svg>
                    {{ link.name }}
                </a>
            {% else %}
                <a href="{{ link.path }}" class="{{ navItemClass }} side-nav__item">
                    <svg class="{{ navItemIconClass }} side-nav__item-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        {{ link.icon|raw }}
                    </svg>
                    {{ link.name }}
                </a>

            {% endif %}
        {% endfor %}
    {% endblock %}
{% endset %}

{# Off-canvas menu for mobile, show/hide based on off-canvas menu state. #}
<div class="lg:hidden m-side-nav" x-show="sidebarOpen" x-cloak>
    <div class="fixed inset-0 flex z-40">
        {# Off-canvas menu overlay, show/hide based on off-canvas menu state. #}
        <div
                class="fixed inset-0 side-nav__overlay"
                x-show="sidebarOpen"
                @click="sidebarOpen = false;"
                x-transition:enter="transition-opacity ease-linear duration-300"
                x-transition:enter-start="opacity-0"
                x-transition:enter-end="opacity-100"
                x-transition:leave="transition-opacity ease-linear duration-300"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
        >
            <div class="absolute inset-0 bg-gray-600 opacity-75"></div>
        </div>

        {# Off-canvas menu, show/hide based on off-canvas menu state. #}
        <div
                class="relative flex-1 flex flex-col max-w-xs w-full pt-5 pb-4 side-nav__inner-container"
                x-show="sidebarOpen"
                x-transition:enter="transition ease-in-out duration-300 transform"
                x-transition:enter-start="-translate-x-full"
                x-transition:enter-end="translate-x-0"
                x-transition:leave="transition ease-in-out duration-300 transform"
                x-transition:leave-start="translate-x-0"
                x-transition:leave-end="-translate-x-full"
        >
            <div class="absolute top-0 right-0 -mr-12 pt-2">
                <button
                        class="ml-1 flex items-center justify-center h-10 w-10 rounded-full focus-ring--white"
                        x-show="sidebarOpen"
                        @click="sidebarOpen = false"
                >
                    <span class="sr-only">Close sidebar</span>
                    <svg class="h-6 w-6 text-white" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            {% if logo|trim is not empty %}
                <div class="flex-shrink-0 flex items-center px-4">
                    <a href="{{ path('app_index') }}">
                        {{ logo }}
                    </a>
                </div>
            {% endif %}

            <nav class="mt-5 flex-shrink-0 h-full overflow-y-auto" aria-label="Sidebar">
                <div class="px-2 space-y-1">
                    {{ links }}

                    <a href="{{ path('app_logout') }}" class="side-nav__item group">
                        <svg class="side-nav__item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd" />
                        </svg>
                        Logout
                    </a>
                </div>
            </nav>
        </div>
        <div class="flex-shrink-0 w-14">
            {# Dummy element to force sidebar to shrink to fit close icon #}
        </div>
    </div>
</div>

{# Static sidebar for desktop #}
<div class="hidden lg:flex lg:flex-shrink-0 side-nav">
    <div class="flex flex-col w-64">
        <div class="flex flex-col h-0 flex-1 side-nav__inner-container">
            <div class="flex-1 flex flex-col pt-5 pb-4 overflow-y-auto">
                {% if logo|trim is not empty %}
                    <div class="flex items-center flex-shrink-0 px-4 side-nav__logo">
                        <a href="{{ path('app_index') }}">
                            {{ logo }}
                        </a>
                    </div>
                {% endif %}

                <div class="mt-5 flex-1 flex flex-col overflow-y-auto">
                    <nav class="px-2 space-y-1">
                        {{ links }}
                    </nav>

                    {% if clock is defined and clock.isConfigurable() %}
                        <hr class="h-px mt-3 bg-lightBlue-900 border-none">
                        <div class="mt-6 flex-1 h-0 ml-3 mr-1 text-white">
                            {% if clock.getConfigurableTime().isOverridden() %}
                                System time is overridden to <span class="text-red-400">{{ clock.time|date }}</span>.
                            {% else %}
                                System time is not overridden, and is currently <span class="text-green-400">{{ clock.time|date }}</span>
                            {% endif %}
                            <br>
                            <a href="{{ path('app_time') }}">Configure time</a>
                        </div>
                    {% endif %}
                </div>
            </div>

            {# Profile section #}
            <div class="flex-shrink-0 flex border-t border-gray-200 p-4 py-2 text-white side-nav__profile">
                <div class="flex-shrink-0 w-full block">
                    <div class="flex items-center">
                        <div>
                            <a class="text-sm link font-medium mb-2" href="{{ path('app_account_overview') }}">
                                {{ app.user.email }}
                            </a>
                            <div class="flex ">
                                <a class="text-xs font-medium link mr-4" href="{{ path('app_help') }}">Help</a>

                                <a class="text-xs font-medium link" href="{{ path('app_logout') }}">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>