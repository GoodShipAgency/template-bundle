{#
    Options:
        title
        tabs: [{ name: string, path: string }]
        useHtmx
    blocks:
        actions
#}

{% set actions %}
    {% block actions %}{% endblock %}
{% endset %}

{% set dropdownButtonClass = "relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left capitalize cursor-default focus:outline-none focus:ring-1 sm:text-sm" %}

<div class="relative pb-5 border-b border-gray-200 sm:pb-0 tabs-nav">
    <div class="md:flex md:items-center md:justify-between">
        {% if title is defined %}
            <h1 class="text-lg leading-6 font-medium text-gray-900 -mb-2 tabs-nav__title">
                {{ title }}
            </h1>
        {% endif %}

        {% if actions|trim is not empty %}
            <div class="mt-3 flex md:mt-0 md:absolute md:top-3 md:right-0 tabs-nav__actions">
                {{ actions }}
            </div>
        {% endif %}
    </div>

    <div class="mt-6">
        {# Dropdown menu on small screens #}
        <div class="mt-1 relative w-full sm:w-64 sm:hidden tabs-nav__dropdown" x-data="{ showDropdown: false }">
            <button
                type="button"
                x-ref="button"
                @click="showDropdown = true"
                aria-haspopup="listbox"
                :aria-expanded="showDropdown"
                aria-labelledby="listbox-label"
                class="{{ dropdownButtonClass }} tabs-nav__dropdown-button"
                aria-expanded="true"
            >
                <span class="w-full inline-flex truncate">
                    <span class="truncate">
                        {% for tab in tabs %}
                            {% if tab.path == app.request.pathInfo() %}
                                {{ tab.name }}
                            {% endif %}
                        {% endfor %}
                    </span>
                </span>
                <span class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" x-description="Heroicon name: selector" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </span>
            </button>

            <div
                class="absolute mt-1 w-full rounded-md bg-white shadow-lg"
                x-show="showDropdown"
                @click.outside="showDropdown = false"
                x-transition:leave="transition ease-in duration-100"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
            >
                <ul x-ref="listbox" tabindex="-1" role="listbox" aria-labelledby="listbox-label" class="max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm">
                    {% if useHtmx is defined and useHtmx == true %}
                         {% for tab in tabs %}
                            <li id="listbox-item-{{ loop.index }}" role="option" class="cursor-default select-none relative text-gray-900 capitalize">
                                {% if tab.path == app.request.pathInfo() %}
                                    <span class="truncate py-2 px-3 w-full block bg-gray-50">{{ tab.name }}</span>
                                {% else %}
                                    <button
                                        class="font-normal truncate py-2 px-3 w-full block text-left"
                                        type="button"
                                        hx-trigger="click"
                                        hx-get="{{ tab.path }}"
                                        hx-target="#slideout-content"
                                        hx-swap="innerHTML"
                                        @click="slideoutOpen = true"
                                    >{{ tab.name }}</button>
                                {% endif %}
                            </li>
                        {% endfor %}
                    {% elseif useJs is defined and useJs == true %}
                        {% for tab in tabs %}
                            <li id="listbox-item-{{ loop.index }}" role="option" class="cursor-default select-none relative text-gray-900 capitalize">
                                {% if tab.path == app.request.pathInfo() %}
                                    <span class="truncate py-2 px-3 w-full block bg-gray-50">{{ tab.name }}</span>
                                {% else %}
                                    <button
                                        class="font-normal truncate py-2 px-3 w-full block text-left"
                                        type="button"
                                        @click="{{ tab.callback }}"
                                    >{{ tab.name }}</button>
                                {% endif %}
                            </li>
                        {% endfor %}
                    {% else %}
                        {% for tab in tabs %}
                            <li id="listbox-item-{{ loop.index }}" role="option" class="cursor-default select-none relative text-gray-900 capitalize">
                                {% if tab.path == app.request.pathInfo() %}
                                    <span class="truncate py-2 px-3 w-full block bg-gray-50">{{ tab.name }}</span>
                                {% else %}
                                    <a href="{{ tab.path }}" class="font-normal truncate py-2 px-3 w-full block">{{ tab.name }}</a>
                                {% endif %}
                            </li>
                        {% endfor %}
                    {% endif %}
                </ul>
            </div>
        </div>

        {# Tabs at small breakpoint and up #}
        <div class="hidden sm:block">
            <nav class="-mb-px flex space-x-8">
                {% if useHtmx is defined and useHtmx == true %}
                    {% for tab in tabs %}
                        {% if tab.path == app.request.pathInfo() %}
                            <span class="whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm tabs-nav__tab--active" aria-current="page">
                                {{ tab.name }}
                            </span>
                        {% else %}
                            <button
                                class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm tabs-nav__tab"
                                type="button"
                                hx-trigger="click"
                                hx-get="{{ tab.path }}"
                                hx-target="#slideout-content"
                                hx-swap="innerHTML"
                                @click="slideoutOpen = true"
                            >
                                {{ tab.name }}
                            </button>
                        {% endif %}
                    {% endfor %}
                {% elseif useJs is defined and useJs == true %}
                    {% for tab in tabs %}
                        {% if tab.path == app.request.pathInfo() %}
                            <span class="whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm tabs-nav__tab--active" aria-current="page">
                                {{ tab.name }}
                            </span>
                        {% else %}
                            <button
                                class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm tabs-nav__tab"
                                type="button"
                                @click="{{ tab.callback }}"
                            >
                                {{ tab.name }}
                            </button>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    {% for tab in tabs %}
                        {% if tab.path == app.request.pathInfo() %}
                            <a href="{{ tab.path }}" class="whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm tabs-nav__tab--active" aria-current="page">
                                {{ tab.name }}
                            </a>
                        {% else %}
                            <a href="{{ tab.path }}" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm">
                                {{ tab.name }}
                            </a>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </nav>
        </div>
    </div>
</div>